---
title: "Zero-modified Poisson distribution"
author: "Marcelo Ventura Freire"
format: 
  # pdf
  html
execute: 
  echo: false
---

```{r}
#| label: setup
#| include: false

library(tidyverse)  # my go-to package
library(glue)
library(actuar)     # dzmpois() 
library(latex2exp)  # TeX()
```



## Introduction

I did not invented this model, but I will give the proper credits later, when I write a proper introduction.

### Examples of applications

TO-DO: examples of phenomena with occurrences of over- and under-occurrences of zero observations.



## Definitions

From the (regular) Poisson distribution $X \sim Poi(\lambda)$ with $\lambda>0$
$$
P(X=x) = \frac{e^{-\lambda}\lambda^x}{x!}, \qquad x\in\{0,1,2,\ldots\},
$$
we define:

- the *truncated Poisson distribution* $Y \sim TruncPoi(\lambda)$, with 
  $\lambda>0$
  $$
  P(Y=y) 
    = P(X=y|X>0) 
    = \frac{P(X=y)}{1-P(X=0)}
    = \frac{\frac{e^{-\lambda}\lambda^y}{y!}}{(1-e^{-\lambda})}
    = \frac{\lambda^y}{(e^\lambda-1)y!},
  $$
- the *zero-modified Poisson distribution* $Z \sim ZModPoi(p, \lambda)$, with 
  $p\in(0,1)$ and $\lambda>0$
  $$
  P(Z=z) =
    \begin{cases}
    p 
      & z=0\\
    (1-p) P(Y=z) 
      = \frac{(1-p)\lambda^y}{(e^\lambda-1)y!},
      & z=1,2,\ldots
    \end{cases}
  $$


Note that the regular, the zero-inflated, the zero-deflated, and the truncated Poisson distributions can be obtained respectively when $p=P(X=0)=e^{-\lambda}$, $p>e^{-\lambda}$, $p<e^{-\lambda}$, and $p=0$ (which can be seen as a limit case of the previous).

```{r}
#| label: graph-1st-param

plot.distribs <- function(lambda) {
  p0 <- dpois(0, lambda)
  xfinal <- max(lambda*2,5)
  
  tibble(
    x = 0:xfinal,
    RegPoi =  
      dzmpois(x, lambda, p0),
    TruncPoi =
      dzmpois(x, lambda, 0),
    ZDeflPoi = 
      dzmpois(x, lambda, 0.5 * p0),
    ZInfPoi = 
      dzmpois(x, lambda, 1.5 * p0),
  ) |> 
    pivot_longer(
      cols = RegPoi:ZInfPoi,
      values_to = "y",
      names_to = "distrib",
    ) |> 
    ggplot() +
    aes(x = x, y = y, group = distrib, color = distrib) +
    geom_point() +
    geom_line() +
    labs(
      title = "Comparing regular, truncated, zero-deflated, and zero-inflated",
      subtitle = 
        r"[$\lambda={lambda}$ and $p=P(X=0), 0, 0.5 \cdot P(X=0), 1.5 \cdot P(X=0)]" |> 
        glue() |> 
        TeX()
    ) +
    xlab("z") +
    ylab("P(Z=z)") +
    scale_x_continuous(
      breaks = 0:xfinal,
      labels = scales::label_number(accuracy = 1)
    ) +
    annotate(
      "text",
      x = -0.2,
      y = c(p0, 0, 0.5 * p0, 1.5 * p0),
      label = c(p0, 0, 0.5 * p0, 1.5 * p0) |> round(2) |> as.character(),
      hjust = 1,       # Adjust horizontal alignment (0 for left-aligned)
      size = 3
    ) +
    theme_classic()
}

plot.distribs(lambda = 0.5)
plot.distribs(lambda = 1)
plot.distribs(lambda = 2)
plot.distribs(lambda = 3)
```



A second parametrization for the zero-modified Poisson distribution can be obtained setting $p=e^{-\lambda+\theta}$, so that, for $Z \sim ZModPoi(\theta, \lambda)$, we have
$$
P(Z=z) = 
\begin{cases}
e^{-\lambda+\theta}, 
  & z=0\\
\frac{(1-e^{-\lambda+\theta})\lambda^y}{(e^{\lambda}-1)y!}
  & z=1,2,\ldots
\end{cases}
$$
in which case, regular, zero-inflated, and zero-deflated Poisson can be obtained when $\theta=0$, $\theta>0$, and $\theta<0$. However, a constraint must be set on $\theta$ so that $0<p<1$:
$$
e^{-\lambda+\theta}<1
  \Leftrightarrow
    -\lambda+\theta<0
  \Leftrightarrow
    \theta<\lambda.
$$
This way, we can refer to $Z \sim ZModPoi(\theta,\lambda)$ for $\lambda>0$ and $\theta<\lambda$ as the model in its second parametrization.

For algebraic ease, we may use a third parametrization setting $1-p=e^\gamma$, subject to $0<e^\gamma<1 \Leftrightarrow \gamma<0$, 
$$
P(Z=z) = 
\begin{cases}
1-e^{\gamma}, 
  & z=0\\
\frac{e^\gamma\lambda^y}{(e^{\lambda}-1)y!}
  & z=1,2,\ldots
\end{cases}
$$
so that the parametrization used in each context will be defined by the use of the three different parameters.






